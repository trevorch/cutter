import{E as oe,i as be}from"./element-plus-CRGBzuq5.js";import{f as W,g as X,B as Ce,l as Te,w as Se,Q as ze}from"./@element-plus-By79ymwD.js";import{r as k,j as ce,c as G,o as A,a as M,M as Y,u,d as ue,k as ge,ag as S,aq as xe,I as he,G as de,H as o,P as t,L as P,S as Ee,w as De,J as ve,O as me,a6 as $e,D as Me,n as Pe,X as Ie,Q as je,at as Le}from"./@vue-C01xNfPK.js";import{d as pe,c as Oe}from"./pinia-CKuVeK4o.js";import{P as He}from"./plyr-CZIZ1zVJ.js";import{H as ie}from"./hls.js-DWnTp5j0.js";import{f as _e}from"./flv.js-HEV2ctDJ.js";import"./lodash-es-S0Y0Up6J.js";import"./@vueuse-ZGnAJoZm.js";import"./@popperjs-D_chPuIy.js";import"./@ctrl-r5W6hzzQ.js";import"./dayjs-NaOncrXL.js";import"./async-validator-9PlIezaS.js";import"./memoize-one-BdPwpGay.js";import"./normalize-wheel-es-BQoi3Ox2.js";import"./@floating-ui-DwceP2Gb.js";(function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))y(r);new MutationObserver(r=>{for(const f of r)if(f.type==="childList")for(const H of f.addedNodes)H.tagName==="LINK"&&H.rel==="modulepreload"&&y(H)}).observe(document,{childList:!0,subtree:!0});function d(r){const f={};return r.integrity&&(f.integrity=r.integrity),r.referrerPolicy&&(f.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?f.credentials="include":r.crossOrigin==="anonymous"?f.credentials="omit":f.credentials="same-origin",f}function y(r){if(r.ep)return;r.ep=!0;const f=d(r);fetch(r.href,f)}})();function Ke(m,l="未知错误"){if(m instanceof Error)return m.message;if(typeof m=="string")return m;if(typeof m=="object"&&m!==null&&"message"in m&&typeof m.message=="string")return m.message;try{return JSON.stringify(m)}catch{return l}}const se={showClose:!0,dangerouslyUseHTMLString:!0,duration:3e3},le=`style="
      width: 500px; 
      word-wrap: break-word;
      word-break: break-all;
      white-space: normal;
      overflow-wrap: anywhere;
    "`;function Q(m,l){const d=Ke(m),y=l?`${l}: ${d}`:d;oe.error({...se,message:`
    <div ${le}>
      ${y}
    </div>
    `})}function I(m){oe.error({...se,message:`
    <div ${le}>
      ${m}
    </div>
    `})}function Ue(m){oe.info({...se,message:`
    <div ${le}>
      ${m}
    </div>
    `})}function J(m){oe.success({...se,message:`
    <div ${le}>
      ${m}
    </div>
    `})}const Z=m=>{try{const[l,d]=m.split("."),[y,r,f]=l.split(":").map(Number),H=d?parseInt(d.padEnd(3,"0")):0;return y*3600+r*60+f+H/1e3}catch{return 0}},O=m=>{const l=Math.round(m%1*1e3),d=Math.floor(m),y=Math.floor(d/3600),r=Math.floor(d%3600/60),f=d%60;return`${String(y).padStart(2,"0")}:${String(r).padStart(2,"0")}:${String(f).padStart(2,"0")}.${String(l).padStart(3,"0")}`},ee=pe("player",()=>{const m=k(""),l=k(null),d=k(null),y=k(null),r=k(null),f=k(null),H=i=>{l.value=new He(i,{hideControls:!1,controls:["play-large","current-time","progress","duration","mute","volume","fullscreen","settings"],blankVideo:"https://cdn.plyr.io/static/blank.mp4"})},z=i=>{r.value=i,m.value=i.date;const v=i.urls[0],_={type:"video",sources:[{src:v,type:V(v)}]};K(_).then(()=>{var w;return(w=l.value)==null?void 0:w.play()})},V=i=>i.includes(".m3u8")?"application/x-mpegURL":i.includes(".flv")?"video/x-flv":"video/mp4",K=async i=>{var _,w,E;(_=d.value)==null||_.destroy(),d.value=null,(w=y.value)==null||w.destroy(),y.value=null;const v=i.sources[0].src.includes(".m3u8")?"hls":i.sources[0].src.includes(".flv")?"flv":"html5";try{v!==f.value&&await((E=l.value)==null?void 0:E.stop()),l.value.source=i,v==="hls"&&ie.isSupported()?await R(i.sources[0].src):v==="flv"&&_e.isSupported()&&await F(i.sources[0].src),f.value=v}catch(j){console.error("源切换失败:",j)}},R=async i=>new Promise(v=>{d.value=new ie,d.value.loadSource(i),d.value.attachMedia(l.value.media),d.value.on(ie.Events.MANIFEST_PARSED,v)}),F=async i=>{y.value=_e.createPlayer({type:"flv",url:i}),y.value.attachMediaElement(l.value.media),y.value.load(),await y.value.play()},U=k(!1);return{player:l,initPlayer:H,switchSource:K,playStream:z,title:m,data:r,autoPlay:U,jumpTo:i=>{const v=Z(i);if(l.value&&v>0)try{l.value.currentTime=v,U.value?l.value.play():l.value.pause()}catch(_){Q(_,"跳转播放失败，请检查播放器状态")}}}}),Ve={class:"video-wrapper"},Re={class:"title"},Ne={class:"plyr-container"},Ae={__name:"Player",setup(m){const l=ee(),d=k(null);return ce(()=>{l.initPlayer(d.value)}),(y,r)=>(A(),G("div",Ve,[M("h3",Re,Y(u(l).title),1),M("div",Ne,[M("video",{class:"player",ref_key:"videoRef",ref:d,playsinline:""},null,512)])]))}},fe=pe("editor",()=>{const m=k(!1),l=k(!1),d=k(""),y=k(null),r=5e3,f=k(r),H=v=>{l.value=!0,y.value=v,d.value=v.date,$()},z=k([]),V=v=>{try{const[_,w]=v.split("."),[E,j,C]=_.split(":").map(Number);return E*3600+j*60+C}catch(_){console.error(_)}},K=k(new Map),R=()=>{K.value.clear(),z.value.forEach((v,_)=>{try{const w=V(v.time);K.value.has(w)||K.value.set(w,_)}catch(w){console.error(`错误处理时间戳 ${v.time}（索引 ${_}）: ${w}`)}})},F=v=>{if(!z.value)return;const _=f.value+v;f.value=Math.max(_,0);const w=v/1e3;z.value=z.value.map(E=>{const C=Z(E.time)+w;return{...E,time:O(Math.max(C,0))}}),R()},U=()=>{if(!z.value)return;const _=(f.value-r)/1e3;z.value=z.value.map(w=>{const j=Z(w.time)-_;return{...w,time:O(Math.max(j,0))}}),f.value=r,R()},$=async()=>{var v;m.value=!0;try{const _=await fetch(`srts/${(v=y.value)==null?void 0:v.id}`);if(!_.ok)throw new Error(`HTTP error! status: ${_.status}`);z.value=await _.json();const w=f.value/1e3;z.value=z.value.map(E=>{const C=Z(E.time)+w;return{...E,time:O(Math.max(C,0))}}),R()}catch(_){console.error("数据获取失败:",_),Q(_,"字幕数据加载失败，请稍后重试"),z.value=[]}finally{m.value=!1}};return{open:l,title:d,edit:H,data:y,timelineData:z,loading:m,shiftCount:f,shiftSubtitles:F,timeToSeconds:Z,secondsToTime:O,resetSubtitles:U,timeMap:K,timeToKey:V,getSubtitles:(v,_)=>{var g;const w=k([]);if(!((g=z.value)!=null&&g.length))return console.error("时间轴数据未加载"),w;const E=V(O(v)),j=V(O(_)),C=K.value.get(E),c=K.value.get(j);if(typeof C!="number"||typeof c!="number")return console.error("无法匹配有效的时间段"),w;const a=Math.max(0,C),s=Math.min(z.value.length-1,c),[e,n]=a<=s?[a,s]:[s,a];return w.value=z.value.slice(e,n+1),w}}}),Fe=["onClick"],Be=["onClick"],qe={style:{display:"flex",gap:"0","justify-content":"flex-end"}},Je=ue({__name:"Playlist",setup(m){const l=ee(),d=fe(),y=k(""),r=k(!0),f=k([]),H=async()=>{try{const $=await fetch("video.json");if(!$.ok)throw new Error(`HTTP error! status: ${$.status}`);f.value=await $.json()}catch($){Q($,"数据加载失败")}finally{r.value=!1}},z=ge(()=>{const $=y.value.toLowerCase();return f.value.filter(i=>i.id.toLowerCase().includes($)||i.date.toLowerCase().includes($))}),V=async $=>{var i;((i=$.urls)==null?void 0:i.length)>0?await R($.urls[0],"链接已复制到剪贴板","链接复制失败"):I("该记录没有可用的链接")},K=async $=>{$.id?await R($.id,"ID已复制到剪贴板","ID复制失败"):I("该记录没有可用的ID")},R=async($,i,v)=>{try{await navigator.clipboard.writeText($),J(i)}catch(_){Q(_,v)}},F=$=>{var i;(i=$.urls)!=null&&i.length&&($.urls[0],l.playStream($),d.edit($))},U=$=>{var i;(i=$.urls)!=null&&i.length&&($.urls[0],l.playStream($))};return ce(()=>{H()}),($,i)=>{const v=S("el-table-column"),_=S("el-input"),w=S("el-button"),E=S("el-table"),j=xe("loading");return he((A(),de(E,{data:z.value,"default-sort":{prop:"date",order:"descending"},height:"100%",style:{width:"100%"}},{default:o(()=>[t(v,{fixed:"",label:"日期",prop:"date",sortable:"",width:"140"},{default:o(C=>[M("span",{class:"clickable-text",onClick:c=>V(C.row)},Y(C.row.date),9,Fe)]),_:1}),t(v,{fixed:"",label:"标识",prop:"id",width:"180"},{default:o(C=>[M("span",{class:"clickable-text",onClick:c=>K(C.row)},Y(C.row.id),9,Be)]),_:1}),t(v,{fixed:"right",align:"right",width:"115"},{header:o(()=>[t(_,{modelValue:y.value,"onUpdate:modelValue":i[0]||(i[0]=C=>y.value=C),size:"small",placeholder:"输入关键词搜索"},null,8,["modelValue"])]),default:o(C=>{var c,a;return[M("div",qe,[t(w,{plain:"",size:"small",onClick:s=>F(C.row),type:C.row.hasSrt?"success":"warning",disabled:!C.row.hasSrt},{default:o(()=>i[1]||(i[1]=[P(" 编辑 ")])),_:2},1032,["onClick","type","disabled"]),t(w,{plain:"",size:"small",onClick:s=>U(C.row),type:(c=C.row.urls)!=null&&c.length?"success":"warning",disabled:!((a=C.row.urls)!=null&&a.length)},{default:o(()=>i[2]||(i[2]=[P(" 播放 ")])),_:2},1032,["onClick","type","disabled"])])]}),_:1})]),_:1},8,["data"])),[[j,r.value]])}}}),ke=pe("picker",()=>{const m=k(!1),l=k(!1),d=k("");return k(null),k(0),{open:l,title:d,loading:m}}),Ye={style:{display:"flex",gap:"0","justify-content":"flex-start"}},Qe={key:0,class:"loading-state"},Ge={class:"time-label"},We=["onClick"],Xe={key:1,class:"empty-state"},Ze={class:"footer-container"},et={class:"time-shift-controls"},tt={class:"time-shift-controls"},te=50,ne=5e3,nt=ue({__name:"Editor",setup(m){const l=fe(),d=ee(),y=ke(),r=k(1e3),f=c=>{const a=r.value+c;r.value=Math.max(te,Math.min(ne,a))},H=k(["你好","晚上好","拜拜","再见"]),z=c=>H.value.some(a=>c.includes(a)),V=ge(()=>l.timelineData.map((c,a)=>({text:c.text,index:a})).filter(({text:c})=>z(c)).map(({index:c})=>c).sort((c,a)=>c-a)),K=()=>{const c=V.value;if(c.length===0){I("未找到包含关键字的字幕行");return}let a=0,s=c.length-1,e=-1;for(;a<=s;){const n=Math.floor((a+s)/2);c[n]<i.value?(e=c[n],a=n+1):s=n-1}e===-1&&(e=c[c.length-1]),_(e)},R=()=>{const c=V.value;if(c.length===0){I("未找到包含关键字的字幕行");return}let a=0,s=c.length-1,e=-1;for(;a<=s;){const n=Math.floor((a+s)/2);c[n]>i.value?(e=c[n],s=n-1):a=n+1}e===-1&&(e=c[0]),_(e)},F=k(),U=k([]),$=c=>{c instanceof HTMLElement&&U.value.push(c)},i=k(0),v=async()=>{if(!d.player)return;const c=d.player.currentTime,a=O(c),s=l.timeToKey(a),e=l.timeMap.get(s);typeof e=="number"&&e!==i.value&&(i.value=e,await Pe(),setTimeout(()=>_(e),50))},_=c=>{const a=F.value,s=U.value[c];if(s instanceof HTMLElement&&a){const n=s.offsetTop-a.clientHeight/2;a.scrollTo({top:n,behavior:"smooth"})}},w=k(595),E=k();let j=null;ce(()=>{E.value=document.querySelector(".grid-section.bottom"),E.value&&(j=new ResizeObserver(c=>{for(const a of c){const{height:s}=a.contentRect;w.value=s}}),j.observe(E.value)),d.player.on("timeupdate",v)}),Ee(()=>{j&&E.value&&j.unobserve(E.value),d.player.off("timeupdate",v),U.value=[]}),De(()=>l.timelineData,()=>{U.value=[]});const C=async()=>{var c,a;try{const s=(c=d.player)==null?void 0:c.media;if(!(s instanceof HTMLVideoElement)){I("无法获取视频元素");return}const e=document.createElement("canvas");e.width=s.videoWidth,e.height=s.videoHeight;const n=e.getContext("2d");if(!n){Q("无法创建画布上下文");return}n.drawImage(s,0,0,e.width,e.height);const g=e.toDataURL("image/jpeg",.9),h=document.createElement("a"),T=new Date().toISOString().replace(/[:.]/g,"-").slice(0,19);h.download=`capture_${(a=l.data)==null?void 0:a.id}_${T}.jpg`,h.href=g,document.body.appendChild(h),h.click(),document.body.removeChild(h),J("截图已保存")}catch(s){Q(`截图失败: ${s instanceof Error?s.message:s}`)}};return(c,a)=>{const s=S("Expand"),e=S("el-icon"),n=S("el-button"),g=S("Top"),h=S("Bottom"),T=S("Camera"),D=S("el-text"),N=S("Minus"),q=S("el-drawer");return A(),de(q,{modelValue:u(l).open,"onUpdate:modelValue":a[12]||(a[12]=b=>u(l).open=b),direction:"btt",modal:!1,size:w.value,onOpened:a[13]||(a[13]=b=>u(l).shiftSubtitles(0))},{header:o(()=>[M("div",Ye,[t(n,{size:"small",type:u(y).open?"success":"",circle:""},{default:o(()=>[t(e,{onClick:a[0]||(a[0]=b=>u(y).open=!u(y).open)},{default:o(()=>[t(s)]),_:1})]),_:1},8,["type"]),t(n,{onClick:a[1]||(a[1]=b=>u(d).autoPlay=!u(d).autoPlay),type:u(d).autoPlay?"success":"",size:"small",circle:""},{default:o(()=>a[14]||(a[14]=[P("A")])),_:1},8,["type"]),t(n,{size:"small",circle:""},{default:o(()=>[t(e,{onClick:K},{default:o(()=>[t(g)]),_:1})]),_:1}),t(n,{size:"small",circle:""},{default:o(()=>[t(e,{onClick:R},{default:o(()=>[t(h)]),_:1})]),_:1}),t(n,{size:"small",circle:""},{default:o(()=>[t(e,{onClick:C},{default:o(()=>[t(T)]),_:1})]),_:1}),t(D,{class:"mx-1",type:"warning"},{default:o(()=>{var b;return[P(Y((b=u(l).data)==null?void 0:b.id),1)]}),_:1})])]),default:o(()=>[M("div",{class:"timeline-container",ref_key:"containerRef",ref:F},[u(l).loading?(A(),G("div",Qe,[t(e,{class:"is-loading",color:"#409EFF",size:20},{default:o(()=>[t(u(Te))]),_:1}),a[15]||(a[15]=M("span",null,"正在加载字幕数据...",-1))])):ve("",!0),(A(!0),G(me,null,$e(u(l).timelineData,(b,B)=>(A(),G("div",{key:B,class:"timeline-item",ref_for:!0,ref:$},[M("span",Ge,Y(b.time),1),M("span",{class:Me(["content-text",{highlight:B==i.value,keyword:z(b.text)}]),onClick:p=>u(d).jumpTo(b.time)},Y(b.text),11,We)]))),128)),!u(l).loading&&u(l).timelineData.length===0?(A(),G("div",Xe,[t(e,null,{default:o(()=>[t(u(Se))]),_:1}),a[16]||(a[16]=M("span",null,"暂无字幕数据",-1))])):ve("",!0)],512)]),footer:o(()=>[M("div",Ze,[M("div",et,[t(n,{onClick:a[2]||(a[2]=b=>f(-1e3)),disabled:r.value<=te,size:"small"},{default:o(()=>[t(e,null,{default:o(()=>[t(u(W))]),_:1}),t(e,null,{default:o(()=>[t(u(W))]),_:1}),t(e,null,{default:o(()=>[t(u(W))]),_:1})]),_:1},8,["disabled"]),t(n,{onClick:a[3]||(a[3]=b=>f(-500)),disabled:r.value<=te,size:"small"},{default:o(()=>[t(e,null,{default:o(()=>[t(u(W))]),_:1}),t(e,null,{default:o(()=>[t(u(W))]),_:1})]),_:1},8,["disabled"]),t(n,{onClick:a[4]||(a[4]=b=>f(-50)),disabled:r.value<=te,size:"small"},{default:o(()=>[t(e,null,{default:o(()=>[t(u(W))]),_:1})]),_:1},8,["disabled"]),M("span",{class:"count",onClick:a[5]||(a[5]=b=>r.value=50)},Y(r.value),1),t(n,{onClick:a[6]||(a[6]=b=>f(50)),disabled:r.value>=ne,size:"small"},{default:o(()=>[t(e,null,{default:o(()=>[t(u(X))]),_:1})]),_:1},8,["disabled"]),t(n,{onClick:a[7]||(a[7]=b=>f(500)),disabled:r.value>=ne,size:"small"},{default:o(()=>[t(e,null,{default:o(()=>[t(u(X))]),_:1}),t(e,null,{default:o(()=>[t(u(X))]),_:1})]),_:1},8,["disabled"]),t(n,{onClick:a[8]||(a[8]=b=>f(1e3)),disabled:r.value>=ne,size:"small"},{default:o(()=>[t(e,null,{default:o(()=>[t(u(X))]),_:1}),t(e,null,{default:o(()=>[t(u(X))]),_:1}),t(e,null,{default:o(()=>[t(u(X))]),_:1})]),_:1},8,["disabled"])]),M("div",tt,[t(n,{onClick:a[9]||(a[9]=b=>u(l).shiftSubtitles(-r.value)),disabled:u(l).shiftCount===0},{default:o(()=>[t(e,null,{default:o(()=>[t(N)]),_:1})]),_:1},8,["disabled"]),M("span",{class:"count",onClick:a[10]||(a[10]=(...b)=>u(l).resetSubtitles&&u(l).resetSubtitles(...b))},Y(u(l).shiftCount),1),t(n,{onClick:a[11]||(a[11]=b=>u(l).shiftSubtitles(r.value))},{default:o(()=>[t(e,null,{default:o(()=>[t(u(Ce))]),_:1})]),_:1})])])]),_:1},8,["modelValue","size"])}}}),ot={class:"segment-container"},st={class:"time-controls"},lt={class:"time-controls"},at={class:"time-controls"},rt={class:"card-footer"},it=`以下内容每行是一个标题：
心智阳光健康，本科大二学生，聊天很是投缘，大冰不舍挂断

人为什么需要亲密关系？大冰深度分析，看完人都通透了

主动要礼物！聊天高端局，“泄露天机”太多，大冰“索要”礼物

如何把事情处理得圆润得体？大冰深度教学，家庭职场都受用

情侣裂痕是如何产生的？大冰深度分析，值得反复观看

光长年龄不长心智是一种什么体验？大冰对话32岁女画师，表现惊掉你下巴

颠覆你的认知：如何炼成顶级倾听力？大冰独家分享！带你突破沟通瓶颈！

如何把握相处的底层逻辑？大冰深度分析，职场婚姻都受用

精神未断奶是一种什么体验？大冰对话女硕士，思维表现大跌眼镜

如何克服自我否定的毛病？大冰深度教学，看完终身受益

大冰：慢就是最好的快，给毕业生的建议


总结以下对话内容，并参考以上标题，为以下对话内容起一个正向接地气的标题，同时给出建议标签，标签要每行一个，标题和标签要方便复制：


`,ct=ue({__name:"Picker",setup(m){const l=ee(),d=ke(),y=fe(),r=Ie([f()]);function f(){return{id:crypto.randomUUID(),startTime:0,endTime:0,duration:0,isK:!1}}const H=s=>{r.splice(s+1,0,f())},z=s=>{r.length>1&&r.splice(s,1)},V=s=>{if(s>0){const e=r.splice(s,1)[0];r.splice(s-1,0,e)}},K=s=>{if(s<r.length-1){const e=r.splice(s,1)[0];r.splice(s+1,0,e)}};function R(s){if(!l.player)return;const e=l.player.currentTime,n=r[s];n.startTime=e}function F(s){if(!l.player)return;const e=l.player.currentTime,n=r[s];n.endTime=e}function U(s,e){var x;const n=r[s],g=n.isK?"-k":"";let h=(x=l.data)==null?void 0:x.urls[0];if(!h)throw I("请先播放视频"),new Error("请先播放视频");const T=h.match(/\/([^\/]+)\.mp4$/),D=T?T[1]:(()=>{const re=new Date;return`${re.getFullYear()}${(re.getMonth()+1).toString().padStart(2,"0")}${re.getDate().toString().padStart(2,"0")}`})();if(!n.startTime||!n.endTime)throw I("请先设置开始和结束时间"),new Error("请先设置开始和结束时间");const N=O(n.startTime),q=O(n.endTime),b=N.replace(/:/g,"."),B=q.replace(/:/g,".");let p="yt-dlp --no-check-certificate";p=`${p} --download-sections "*${N}-${q}"`,p=`${p} --force-keyframes-at-cuts`;const L="~/storage/downloads/Reqable/";return e=="video"&&(p=`${p} --merge-output-format mp4 -o "${L}${D}_${b}-${B}.mp4"`),e=="audio"&&(p=`${p} ${g} -x --audio-format mp3 --postprocessor-args "ffmpeg:-c:a libmp3lame -b:a 32k -minrate 32k -maxrate 32k -bufsize 64k -ac 1 -ar 22050" -o "${L}${D}_${b}-${B}.mp3"`),p=`${p} '${h}' `,p}function $(s,e){var L;const n=r[s],g=n.isK?"-k":"";let h=(L=l.data)==null?void 0:L.urls[0];if(!h)throw I("请先播放视频"),new Error("请先播放视频");const T=h.match(/\/([^\/]+)\.mp4$/),D=T?T[1]:(()=>{const x=new Date;return`${x.getFullYear()}${(x.getMonth()+1).toString().padStart(2,"0")}${x.getDate().toString().padStart(2,"0")}`})();if(!n.startTime||!n.endTime)throw I("请先设置开始和结束时间"),new Error("请先设置开始和结束时间");const N=O(n.startTime),q=O(n.endTime),b=N.replace(/:/g,"."),B=q.replace(/:/g,".");let p=`--download-sections "*${N}-${q}"`;return e=="video"&&(p=`${p} --merge-output-format mp4 -o "${D}_${b}-${B}.mp4"`),e=="audio"&&(p=`${p} ${g} -x --audio-format mp3 --postprocessor-args "ffmpeg:-c:a libmp3lame -b:a 32k -minrate 32k -maxrate 32k -bufsize 64k -ac 1 -ar 22050" -o "${D}_${b}-${B}.mp3"`),p}async function i(){var e;const s=(e=l.data)==null?void 0:e.urls[0];if(!s){I("请先播放视频");return}try{await navigator.clipboard.writeText(s),J(`链接已复制：${s}`)}catch(n){console.error(n),I("复制失败，请手动复制")}}async function v(){var e;const s=(e=l.data)==null?void 0:e.id;if(!s){I("请先播放视频");return}try{await navigator.clipboard.writeText(s),J(`ID已复制：${s}`)}catch(n){console.error(n),I("ID失败，请手动复制")}}async function _(s,e,n){let g="";switch(e){case"dlp":g=U(s,n);break;case"seal":g=$(s,n);break}try{await navigator.clipboard.writeText(g),J(`命令已复制：${g}`)}catch(h){console.error(h),I("复制失败，请手动复制")}}const w=async s=>{const e=[];r.forEach((n,g)=>{console.log(`Index: ${g}`,n),e.push(U(g,s))});try{await navigator.clipboard.writeText(e.join(`
`)),J(`命令已复制：${e.join("<br/>")}`)}catch(n){console.error(n),I("复制失败，请手动复制")}},E=k(!1);async function j(){var T;let s=(T=l.data)==null?void 0:T.urls[0];if(!s){I("请先播放视频");return}const e=s.match(/\/([^\/]+)\.mp4$/),n=e?e[1]:(()=>{const D=new Date;return`${D.getFullYear()}${(D.getMonth()+1).toString().padStart(2,"0")}${D.getDate().toString().padStart(2,"0")}`})(),g=r.filter(D=>D.startTime<D.endTime).map((D,N)=>`${O(D.startTime)}-${O(D.endTime)}`);if(!g.length){I("请先至少设置一个开始和结束时间");return}const h=`dlp ${E.value?"keep":"delete"} '${s}' ${n} ${g.join(" ")}`;try{C(h),await navigator.clipboard.writeText(h),J(`命令已复制：${h}`)}catch(D){console.error(D),Q(D,"复制失败，请手动复制")}}async function C(s){try{const e=await fetch("http://localhost:8080/run",{method:"POST",headers:{"Content-Type":"text/plain"},body:s});if(!e.ok)throw new Error(`HTTP 错误: ${e.status}`);const g=(await e.json()).task_id;c(g)}catch(e){Q(e,"请求失败: ")}}function c(s){const e=setInterval(async()=>{var n;try{const g=await fetch(`http://localhost:8080/progress/${s}`);if(!g.ok)throw new Error(`进度查询失败: ${g.status}`);const h=await g.json(),T=(n=h.recent_log)!=null&&n.length?`

最近日志:
`+h.recent_log.join(`
`):"";Ue(T),h.status==="completed"&&(clearInterval(e),J(`处理完成✅ (状态: ${h.status})${T}`)),h.status==="failed"&&(clearInterval(e),I(`处理完成✅ (状态: ${h.status})${T}`))}catch(g){clearInterval(e),Q(g,"监控失败: ")}},1e3)}async function a(s,e){const n=y.getSubtitles(s,e);let g=it;n.value.map(h=>{const T=h.time.split(".")[0]+" "+h.text+`
`;g+=T});try{await navigator.clipboard.writeText(g),J(`${n.value.length}条字幕已复制`)}catch(h){console.error(h),I("复制失败，请手动复制")}}return(s,e)=>{const n=S("el-button"),g=S("el-input"),h=S("DocumentCopy"),T=S("el-icon"),D=S("CaretLeft"),N=S("CaretRight"),q=S("Minus"),b=S("Plus"),B=S("el-card");return he((A(),de(B,{class:"segment-control-card"},{footer:o(()=>[M("div",rt,[t(n,{size:"small",onClick:i},{default:o(()=>e[11]||(e[11]=[P("复制链接")])),_:1}),t(n,{size:"small",onClick:v},{default:o(()=>e[12]||(e[12]=[P("复制ID")])),_:1}),t(n,{size:"small",onClick:j},{default:o(()=>e[13]||(e[13]=[P("下载片段")])),_:1}),t(n,{size:"small",onClick:e[0]||(e[0]=p=>w("video"))},{default:o(()=>e[14]||(e[14]=[P("复制命令")])),_:1})])]),default:o(()=>[M("div",ot,[(A(!0),G(me,null,$e(r,(p,L)=>(A(),G("div",{key:p.id,class:"segment-item"},[M("div",st,[t(n,{type:"primary",size:"small",onClick:x=>_(L,"seal","audio")},{default:o(()=>e[1]||(e[1]=[P("SA")])),_:2},1032,["onClick"]),t(n,{type:"primary",size:"small",onClick:x=>_(L,"seal","video")},{default:o(()=>e[2]||(e[2]=[P("SV")])),_:2},1032,["onClick"]),t(n,{type:"primary",size:"small",onClick:x=>_(L,"dlp","audio")},{default:o(()=>e[3]||(e[3]=[P("DA")])),_:2},1032,["onClick"]),t(n,{type:"primary",size:"small",onClick:x=>_(L,"dlp","video")},{default:o(()=>e[4]||(e[4]=[P("DV")])),_:2},1032,["onClick"]),t(g,{"model-value":u(y).secondsToTime(p.endTime-p.startTime),size:"small",readonly:""},null,8,["model-value"]),t(n,{size:"small",type:p.isK?"success":"info",onClick:x=>p.isK=!p.isK},{default:o(()=>[P(Y(p.isK?"k开":"k关"),1)]),_:2},1032,["type","onClick"]),t(n,{size:"small",type:"success",onClick:x=>a(p.startTime,p.endTime)},{default:o(()=>[t(T,null,{default:o(()=>[t(h)]),_:1})]),_:2},1032,["onClick"])]),M("div",lt,[t(n,{type:"success",size:"small",onClick:x=>R(L)},{default:o(()=>e[5]||(e[5]=[P("S")])),_:2},1032,["onClick"]),t(n,{type:"success",size:"small",onClick:x=>u(l).jumpTo(u(O)(p.startTime))},{default:o(()=>e[6]||(e[6]=[P("J")])),_:2},1032,["onClick"]),t(n,{type:"success",size:"small",onClick:x=>p.startTime=p.startTime-.5},{default:o(()=>[t(T,null,{default:o(()=>[t(D)]),_:1})]),_:2},1032,["onClick"]),t(n,{type:"success",size:"small",onClick:x=>p.startTime=p.startTime+.5},{default:o(()=>[t(T,null,{default:o(()=>[t(N)]),_:1})]),_:2},1032,["onClick"]),t(g,{"model-value":u(O)(p.startTime),size:"small",readonly:""},null,8,["model-value"]),t(n,{size:"small",onClick:x=>V(L),disabled:L===0||r.length===1},{default:o(()=>e[7]||(e[7]=[P("↑")])),_:2},1032,["onClick","disabled"]),t(n,{size:"small",onClick:x=>z(L),disabled:r.length===1},{default:o(()=>[t(T,null,{default:o(()=>[t(q)]),_:1})]),_:2},1032,["onClick","disabled"])]),M("div",at,[t(n,{type:"danger",size:"small",onClick:x=>F(L)},{default:o(()=>e[8]||(e[8]=[P("E")])),_:2},1032,["onClick"]),t(n,{type:"danger",size:"small",onClick:x=>u(l).jumpTo(u(O)(p.endTime))},{default:o(()=>e[9]||(e[9]=[P("J")])),_:2},1032,["onClick"]),t(n,{type:"danger",size:"small",onClick:x=>p.endTime=p.endTime-.5},{default:o(()=>[t(T,null,{default:o(()=>[t(D)]),_:1})]),_:2},1032,["onClick"]),t(n,{type:"danger",size:"small",onClick:x=>p.endTime=p.endTime+.5},{default:o(()=>[t(T,null,{default:o(()=>[t(N)]),_:1})]),_:2},1032,["onClick"]),t(g,{type:"danger","model-value":u(O)(p.endTime),size:"small",readonly:""},null,8,["model-value"]),t(n,{size:"small",onClick:x=>K(L),disabled:L===r.length-1||r.length===1},{default:o(()=>e[10]||(e[10]=[P("↓")])),_:2},1032,["onClick","disabled"]),t(n,{size:"small",onClick:x=>H(L)},{default:o(()=>[t(T,null,{default:o(()=>[t(b)]),_:1})]),_:2},1032,["onClick"])])]))),128))])]),_:1},512)),[[je,u(d).open]])}}}),we=(m,l)=>{const d=m.__vccOpts||m;for(const[y,r]of l)d[y]=r;return d},ye=we(ct,[["__scopeId","data-v-6b86806f"]]),ut={__name:"App",setup(m){return ee(),(l,d)=>{const y=S("el-col"),r=S("el-row"),f=S("el-container");return A(),G(me,null,[t(ye),t(f,{style:{height:"100vh"}},{default:o(()=>[t(r,{class:"grid-container"},{default:o(()=>[t(y,{class:"grid-section top"},{default:o(()=>[t(Ae)]),_:1}),t(y,{class:"grid-section bottom"},{default:o(()=>[t(Je),t(nt),t(ye)]),_:1})]),_:1})]),_:1})],64)}}},dt=we(ut,[["__scopeId","data-v-d44e3bc6"]]),ae=Le(dt);ae.use(Oe());ae.use(be);for(const[m,l]of Object.entries(ze))ae.component(m,l);ae.mount("#app");
